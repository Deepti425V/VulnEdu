{% extends "base.html" %}
{% block content %}
<style>
.venn-container {
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 22px 0;
    gap: 40px;
}

.venn-diagram {
    position: relative;
    width: 450px;
    height: 350px;
    padding: 20px;
}
.circle {
    position: absolute;
    border-radius: 50%;
    opacity: 0.85;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 12px;
    text-align: center;
    line-height: 1.2;
    border: 3px solid;
}
.cve-circle {
    width: 180px;
    height: 180px;
    background: rgba(99, 164, 255, 0.6);
    border-color: #63a4ff;
    top: 30px;
    left: 60px;
    color: #63a4ff;
}
.cwe-circle {
    width: 180px;
    height: 180px;
    background: rgba(56, 178, 172, 0.6);
    border-color: #38b2ac;
    top: 30px;
    left: 190px;
    color: #38b2ac;
}
.cvss-circle {
    width: 180px;
    height: 180px;
    background: rgba(245, 101, 101, 0.6);
    border-color: #f56565;
    top: 150px;
    left: 125px;
    color: #f56565;
}
.label {
    position: absolute;
    font-weight: bold;
    font-size: 14px;
    z-index: 10;
}
.cve-label {
    top: 70px;
    left: 105px;
    color: #63a4ff;
}
.cwe-label {
    top: 70px;
    left: 255px;
    color: #38b2ac;
}
.cvss-label {
    top: 250px;
    left: 165px;
    color: #f56565;
}
.example {
    position: absolute;
    font-size: 10px;
    background: rgba(0, 0, 0, 0.8);
    padding: 3px 6px;
    border-radius: 4px;
    white-space: nowrap;
    z-index: 5;
}
.cve-example {
    top: 95px;
    left: 75px;
    color: #e2e8f0;
}
.cwe-example {
    top: 95px;
    left: 270px;
    color: #e2e8f0;
}
.cvss-example {
    top: 275px;
    left: 150px;
    color: #e2e8f0;
}
.intersection-label {
    position: absolute;
    font-size: 10px;
    background: rgba(255, 255, 255, 0.9);
    color: #1a202c;
    padding: 3px 6px;
    border-radius: 4px;
    font-weight: 600;
    z-index: 15;
}
.cve-cwe {
    top: 115px;
    left: 185px;
}
.cve-cvss {
    top: 175px;
    left: 115px;
}
.cwe-cvss {
    top: 175px;
    left: 255px;
}
.center-intersection {
    top: 165px;
    left: 170px;
    background: rgba(255, 215, 0, 0.9);
    color: #1a202c;
    font-size: 9px;
}
/* ----------- LEGEND STYLES ----------- */
.legend {
    color: #e3e8f0;
    background: linear-gradient(135deg, #232b45 0%, #1e2640 100%);
    border-radius: 12px;
    box-shadow: 0 6px 24px rgba(0,0,0,0.3);
    border: 1px solid rgba(99, 164, 255, 0.1);
    padding: 18px 24px;
    margin: 0 0 18px 0;
    width: 350px;
}
.legend-title {
    font-weight: bold;
    font-size: 16px;
    margin-bottom: 14px;
    color: #cdd7ff;
}
.legend-item {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
}
.legend-circle {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    margin-right: 12px;
    border: 2px solid #333;
    flex-shrink: 0;
}
.legend-cve {
    background: rgba(99, 164, 255, 0.6);
    border-color: #63a4ff;
}
.legend-cwe {
    background: rgba(56, 178, 172, 0.6);
    border-color: #38b2ac;
}
.legend-cvss {
    background: rgba(245, 101, 101, 0.6);
    border-color: #f56565;
}
.legend-text {
    font-size: 13px;
}
.legend-name {
    margin-bottom: 0;
}
.warning-item .legend-name {
    color: #e74c3c;
}
</style>

<div style="max-width:1400px;margin:0 auto 32px auto;padding-top:18px;">
<h1 style="color:#63a4ff;">CVE vs CWE vs CVSS</h1>
<p style="color:#e2e8f0;font-size:1.07em;">
Vulnerability analysis uses three frame-works: <b>CVE</b>, <b>CWE</b>, and <b>CVSS</b> each provides a unique way to understand risk and weaknesses.
</p>
<table style="color:#e3e8f0;background:linear-gradient(135deg, #232b45 0%, #1e2640 100%);border-radius:12px;width:75%;margin-bottom:18px; border-collapse:collapse;border: 1px solid rgba(99, 164, 255, 0.1);box-shadow: 0 6px 24px rgba(0,0,0,0.3);">
<tr style="background:#232b45;">
    <th style="text-align:center;padding:12px 8px;border-radius:12px 0 0 0;">Framework</th>
    <th style="text-align:center;padding:12px 8px;">Role in Security</th>
    <th style="text-align:center;padding:12px 8px;border-radius:0 12px 0 0;">Sample</th>
</tr>
<tr style="background:rgba(38, 49, 89, 0.4);">
    <td style="text-align:center;padding:10px 8px;"><strong style="color:#63a4ff;">CVE</strong></td>
    <td style="text-align:center;padding:10px 8px;">Specific vulnerability identifier</td>
    <td style="text-align:center;padding:10px 8px;">CVE-2021-34527</td>
</tr>
<tr style="background:rgba(38, 49, 89, 0.4);">
    <td style="text-align:center;padding:10px 8px;"><strong style="color:#38b2ac;">CWE</strong></td>
    <td style="text-align:center;padding:10px 8px;">Type/classification of weakness</td>
    <td style="text-align:center;padding:10px 8px;">CWE-79 (Cross-Site Scripting)</td>
</tr>
<tr style="background:rgba(38, 49, 89, 0.4);">
    <td style="text-align:center;padding:10px 8px;border-radius:0 0 0 12px;"><strong style="color:#f56565;">CVSS</strong></td>
    <td style="text-align:center;padding:10px 8px;">Numerical severity score</td>
    <td style="text-align:center;padding:10px 8px;border-radius:0 0 12px 0;">9.8 (Critical)</td>
</tr>
</table>
<h2 style="color:#cdd7ff;margin-top:32px;">How Are They Connected?</h2>
<ul style="color:#e3e8f0;margin-left:17px;">
    <li><b>CVE</b> records the bug.</li>
    <li><b>CWE</b> classifies what kind of bug it is.</li>
    <li><b>CVSS</b> tells you how dangerous it is.</li>
</ul>
<h2 style="color:#cdd7ff;">Visual Relationship (Venn Diagram)</h2>
<div class="venn-container">
    <div class="venn-diagram">
        <!-- Circles -->
        <div class="circle cve-circle"></div>
        <div class="circle cwe-circle"></div>
        <div class="circle cvss-circle"></div>
        
        <!-- Labels -->
        <div class="label cve-label">CVE</div>
        <div class="label cwe-label">CWE</div>
        <div class="label cvss-label">CVSS</div>
        
        <!-- Examples -->
        <div class="example cve-example">CVE-2021-34527</div>
        <div class="example cwe-example">CWE-79</div>
        <div class="example cvss-example">9.8 Critical</div>
        
        <!-- Intersection Labels -->
        <div class="intersection-label cve-cwe">ID + Type</div>
        <div class="intersection-label cve-cvss">ID + Score</div>
        <div class="intersection-label cwe-cvss">Type + Risk</div>
        <div class="intersection-label center-intersection">Complete Analysis</div>
    </div>
    
    <!-- Legend -->
    <div class="legend">
        <div class="legend-title">How to read this diagram?</div>
        
        <div class="legend-item cve-item">
            <div class="legend-text">
                <div class="legend-name">Each circle is a <strong style="color: #3498db;">FRAMEWORK</strong>.</div>
            </div>
        </div>
        
        <div class="legend-item cve-item">
            <div class="legend-circle legend-cve"></div>
            <div class="legend-text">
                <div class="legend-name">The blue area <strong style="color: #63a4ff;">shows specific vulnerabilities</strong> of the CVE type!</div>
            </div>
        </div>
        
        <div class="legend-item cwe-item">
            <div class="legend-circle legend-cwe"></div>
            <div class="legend-text">
                <div class="legend-name">The teal area <strong style="color: #38b2ac;">shows weakness categories</strong> of the CWE type!</div>
            </div>
        </div>
        
        <div class="legend-item cvss-item">
            <div class="legend-circle legend-cvss"></div>
            <div class="legend-text">
                <div class="legend-name">The red area <strong style="color: #f56565;">shows severity scores</strong> of the CVSS type!</div>
            </div>
        </div>
        
        <div class="legend-item warning-item">
            <div class="legend-text">
                <div class="legend-name"><strong style="color: #e74c3c;">Overlapping areas highlight complete analysis.</strong></div>
            </div>
        </div>
    </div>
</div>
<div style="text-align:center; margin:2.5em 0 1em 0;">
  <a href="{{ url_for('index') }}" style="color:#63a4ff; padding:0.8em 2em; border-radius:6px; font-weight:600; text-decoration:none;">
    ‚Üê Back to Dashboard
  </a>
</div>
</div>
{% endblock %}
